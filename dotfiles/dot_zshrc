# Path!
# add_to_path new/path/thing
function add_to_path()
{
	addition=$1

	if [[ -d "$addition" ]]; then
		export PATH=$addition:$PATH
	else
		echo "path: skipping '$addition'"
	fi
}

if [[ "$(uname)" == "Darwin" ]]; then
	# Original Homebrew path!
	# add_to_path /usr/local/bin

	add_to_path /usr/bin
	add_to_path /bin
	add_to_path /usr/sbin
	add_to_path /sbin

	# add_to_path /usr/X11/bin
	# add_to_path $HOME/.rvm/bin
	# add_to_path $HOME/.composer/vendor/bin

	# New Homebrew location!
	add_to_path /opt/homebrew/bin

	# Python --user installs
	add_to_path $HOME/Library/Python/3.8/bin

	# Uv
	add_to_path $HOME/.local/bin

	# # Homebrew Ruby (which has M1 correctly setup)
	# Nevermind.
	# add_to_path /opt/homebrew/opt/ruby/bin
	# add_to_path /opt/homebrew/lib/ruby/gems/3.0.0/bin
else
	add_to_path $HOME/.rbenv/bin
fi

# Oh, my ZSH!
ZSH=$HOME/.oh-my-zsh
ZSH_THEME="citelao"

zstyle ':omz:update' mode reminder

# Uncomment the following line to use case-sensitive completion.
# CASE_SENSITIVE="true"

# Uncomment the following line to use hyphen-insensitive completion.
# Case-sensitive completion must be off. _ and - will be interchangeable.
# HYPHEN_INSENSITIVE="true"

# Uncomment the following line to disable bi-weekly auto-update checks.
# DISABLE_AUTO_UPDATE="true"

# Uncomment the following line to automatically update without prompting.
# DISABLE_UPDATE_PROMPT="true"

# Uncomment the following line to change how often to auto-update (in days).
# export UPDATE_ZSH_DAYS=13

# Uncomment the following line if pasting URLs and other text is messed up.
# DISABLE_MAGIC_FUNCTIONS="true"

# Uncomment the following line to disable auto-setting terminal title.
# DISABLE_AUTO_TITLE="true"

# Uncomment the following line to enable command auto-correction.
# ENABLE_CORRECTION="true"

# Uncomment the following line if you want to disable marking untracked files
# under VCS as dirty. This makes repository status check for large repositories
# much, much faster.
# DISABLE_UNTRACKED_FILES_DIRTY="true"

# Uncomment the following line if you want to change the command execution time
# stamp shown in the history command output.
# You can set one of the optional three formats:
# "mm/dd/yyyy"|"dd.mm.yyyy"|"yyyy-mm-dd"
# or set a custom format using the strftime function format specifications,
# see 'man strftime' for details.
# HIST_STAMPS="mm/dd/yyyy"

# Would you like to use another custom folder than $ZSH/custom?
# ZSH_CUSTOM=/path/to/new-custom-folder

# User configuration

# export MANPATH="/usr/local/man:$MANPATH"

# You may need to manually set your language environment
# export LANG=en_US.UTF-8

# Compilation flags
# export ARCHFLAGS="-arch x86_64"

# Uncomment the following line to display red dots whilst waiting for completion.
COMPLETION_WAITING_DOTS="true"

if [[ "$(uname)" == "Darwin" ]]; then
	# zsh-syntax-highlighting
	plugins=(git brew macos)
else
	# zsh-syntax-highlighting
	plugins=(git)
fi

if [[ -d "$ZSH" ]]; then
	if [[ -f "$ZSH/oh-my-zsh.sh" ]]; then
		source $ZSH/oh-my-zsh.sh
	else
		echo "Oh-My-ZSH not found in $ZSH; https://ohmyz.sh/"
	fi
fi

# vim, Please!
export EDITOR=vim
export VISUAL=vim
export GIT_EDITOR=vim
export SVN_EDITOR=vim
bindkey -v

# This is redundant with default keybindings.
# https://github.com/ohmyzsh/ohmyzsh/blob/e0766905519fbc7982a590a195ee7c3e8bb594e8/lib/key-bindings.zsh
#
# bindkey "${terminfo[kcuu1]}" up-line-or-beginning-search # but with expected up/down arrow movement
# bindkey "${terminfo[kcud1]}" down-line-or-beginning-search
# bindkey '^[[A' up-line-or-beginning-search 
# bindkey '^[[B' down-line-or-beginning-search

# https://zsh.sourceforge.io/Doc/Release/Zsh-Line-Editor.html
bindkey '^R' history-incremental-search-backward
bindkey '^S' history-incremental-search-forward

# Hey, I like unique history per session. I like spaces in history.
# Invert https://github.com/ohmyzsh/ohmyzsh/blob/e0766905519fbc7982a590a195ee7c3e8bb594e8/lib/history.zsh#L45
setopt no_share_history
setopt no_hist_ignore_space


if [[ "$(uname)" == "Darwin" ]]; then
	export NVM_DIR="/Users/citelao/.nvm"
	[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"  # This loads nvm

	# Don't update before every install.
	export HOMEBREW_NO_AUTO_UPDATE=1
fi

if [[ -d "$HOME/.rbenv" ]]; then
	if [[ "$(uname)" == "Linux" ]]; then
		eval "$(rbenv init -)"
	fi

	if [[ "$(uname)" == "Darwin" ]]; then
		eval "$(rbenv init -)"
	fi
fi

# Ignore errors with this.
unalias gm 2>/dev/null

# Stop updating stuff, Homebrew.
HOMEBREW_NO_AUTO_UPDATE=1


# If cursor is installed, `c` calls cursor.
# Otherwise, `c` calls `code`.
if command -v cursor > /dev/null 2>&1; then
	alias c='cursor'
else
	alias c='code'
fi